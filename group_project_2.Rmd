---
title: 'EDA Project #2'
author: "Dimitri Angelov, Simona Rahi, Sumitra Sankarasubramanian"
date: "11/19/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Load all the csv files
Country <- read.csv("~/working/data_science_folders/data_munging_EDA/group_project_2_munging/world-development-indicators/Country.csv")

CountryNotes <- read.csv("~/working/data_science_folders/data_munging_EDA/group_project_2_munging/world-development-indicators/CountryNotes.csv")

Footnotes <- read.csv("~/working/data_science_folders/data_munging_EDA/group_project_2_munging/world-development-indicators/Footnotes.csv")

Indicators <- read.csv("~/working/data_science_folders/data_munging_EDA/group_project_2_munging/world-development-indicators/Indicators.csv")

Series <- read.csv("~/working/data_science_folders/data_munging_EDA/group_project_2_munging/world-development-indicators/Series.csv", comment.char="#")

SeriesNotes <- read.csv("~/working/data_science_folders/data_munging_EDA/group_project_2_munging/world-development-indicators/SeriesNotes.csv")
```

Now that all our data is loaded in, the next step would be to list all of the different indicators present in this dataset.

```{r}
#Load in the needed packages
library(ggplot2)
library(reshape2)
library(dplyr)
library(readr)
library(plotly)
library(tidyverse)

#Make the country name a factor
Indicators$CountryName <- as.factor(Indicators$CountryName)

#Get the counts
counts <- Indicators %>%
  group_by(IndicatorCode, IndicatorName) %>%
  summarise(NumCountries = n_distinct(CountryName),
            NumYears     = n_distinct(Year),
            FirstYear    = min(Year),
            LastYear     = max(Year))
counts$IndicatorName <- gsub("\\$", "dollar", counts$IndicatorName)
View(counts)

#Create BRICS indicator
brics <- c("BRA", "RUS", "IND", "CHN", "ZAF")
brics.Indicators <- subset(Indicators, CountryCode %in% brics)

#Create the GDP growth (annual %)
GDP_growth_annual_percent <- subset(brics.Indicators, IndicatorCode == "NY.GDP.MKTP.KD.ZG")

#Plot the variable
ggplot(data = GDP_growth_annual_percent, aes(Year, Value)) +
    geom_line(aes(color = CountryCode), size = 0.85) +
    scale_x_continuous(breaks = seq(1960, 2014, 5)) +
    theme_bw(base_size = 12, base_family = "Helvetica")+
    theme_classic() +
    labs(title = "GDP growth increased for most BRICS, especially China") +
    xlab("Year") +
    ylab("Annual Percent Growth")
```


```{r}
#Create the GDP per capita variable current US dollar
GDP_per_capita_current_US <- subset(brics.Indicators, IndicatorCode == "NY.GDP.PCAP.CD")

#Plot the variable
ggplot(data = GDP_per_capita_current_US, aes(Year, Value)) +
    geom_line(aes(color = CountryCode), size = 0.85) +
    scale_x_continuous(breaks = seq(1960, 2014, 5)) +
    theme_bw(base_size = 12, base_family = "Helvetica")+
    theme_classic() +
    labs(title = "GDP per capita has risen sharply for most countries since the early 2000s") +
    xlab("Year") +
    ylab("Current US Dollar")
```


```{r}
#Create the GDP per capita, PPP (current international $)
GDP_per_capita_PPP_international <- subset(brics.Indicators, IndicatorCode == "NY.GDP.PCAP.PP.CD")

#Plot the variable
ggplot(data = GDP_per_capita_PPP_international, aes(Year, Value)) +
    geom_line(aes(color = CountryCode), size = 0.85) +
    scale_x_continuous(breaks = seq(1960, 2014, 5)) +
    theme_bw(base_size = 12, base_family = "Helvetica")+
    theme_classic() +
    labs(title = "GDP per capita, converted through PPP shows Russia is ahead") +
    xlab("Year") +
    ylab("Current International Dollar")
```


```{r}
#Check for adjusted net national income
adjusted_net_national_income <- subset(brics.Indicators, IndicatorCode == "NY.ADJ.NNTY.CD")

#Plot the variable
ggplot(data = adjusted_net_national_income, aes(Year, Value)) +
    geom_line(aes(color = CountryCode), size = 0.85) +
    scale_x_continuous(breaks = seq(1960, 2014, 5)) +
    theme_bw(base_size = 12, base_family = "Helvetica")+
    theme_classic() +
    labs(title = "Adjusted Net National Income has risen sharply for China") +
    xlab("Year") +
    ylab("Current US dollar")
```


```{r}
#Check for Poverty gap at $1.90 a day (2011 PPP) (%)
poverty_gap <- dplyr::filter(brics.Indicators, 
                      IndicatorCode == "SI.POV.GAPS" |
                      IndicatorCode == "NY.GDP.PCAP.CD") %>%
  dplyr::filter(      Year == 1993
                      ) %>%
  pivot_wider(names_from = "IndicatorCode",
              values_from = "Value")

pg_a <- filter(poverty_gap, IndicatorName == "GDP per capita (current US$)") %>%
  select(-IndicatorName, -SI.POV.GAPS)

pg_b <- filter(poverty_gap, IndicatorName == "Poverty gap at $1.90 a day (2011 PPP) (%)") %>%
  select(CountryCode, SI.POV.GAPS)

poverty_gap <- left_join(pg_a, pg_b, by = "CountryCode")

ggplot(data = poverty_gap,
       aes(x = SI.POV.GAPS,
           y = NY.GDP.PCAP.CD,
           color = CountryName)) +
  geom_point(size = 3) +
  labs(y = "GDP per capita",
       x = "Poverty gap at $1.90 a day (2011 PPP) (%)",
       title = "Higher per capita GDP is associated with a smaller poverty gap",
       caption = "Data from 1993") + 
  xlim(0,50) +
  theme_classic()
```



```{r}
#Check for Poverty gap at $3.10 a day (2011 PPP) (%)
poverty_gap <- dplyr::filter(brics.Indicators, 
                      IndicatorCode == "SI.POV.GAP2" |
                      IndicatorCode == "NY.GDP.PCAP.CD") %>%
  dplyr::filter(      Year == 1993
                      ) %>%
  pivot_wider(names_from = "IndicatorCode",
              values_from = "Value")

pg_a <- filter(poverty_gap, IndicatorName == "GDP per capita (current US$)") %>%
  select(-IndicatorName, -SI.POV.GAP2)

pg_b <- filter(poverty_gap, IndicatorName == "Poverty gap at $3.10 a day (2011 PPP) (%)") %>%
  select(CountryCode, SI.POV.GAP2)

poverty_gap <- left_join(pg_a, pg_b, by = "CountryCode")

ggplot(data = poverty_gap,
       aes(x = SI.POV.GAP2,
           y = NY.GDP.PCAP.CD,
           color = CountryName)) +
  geom_point(size = 3) +
  labs(y = "GDP per capita",
       x = "Poverty gap at $3.10 a day (2011 PPP) (%)",
       title = "Higher per capita GDP is associated with a smaller poverty gap",
       caption = "Data from 1993") + 
  xlim(0,50) +
  theme_classic()
```



```{r}
#Check for Poverty headcount ratio at $1.90 a day
poverty_gap <- dplyr::filter(brics.Indicators, 
                      IndicatorCode == "SI.POV.DDAY" |
                      IndicatorCode == "NY.GDP.PCAP.CD") %>%
  dplyr::filter(      Year == 1993
                       ) %>%
  pivot_wider(names_from = "IndicatorCode",
              values_from = "Value")

pg_a <- filter(poverty_gap, IndicatorName == "GDP per capita (current US$)") %>%
  select(-IndicatorName, -SI.POV.DDAY)

pg_b <- filter(poverty_gap, IndicatorName == "Poverty headcount ratio at $1.90 a day (2011 PPP) (% of population)") %>%
  select(CountryCode, SI.POV.DDAY)

poverty_gap <- left_join(pg_a, pg_b, by = "CountryCode")

ggplot(data = poverty_gap,
       aes(x = SI.POV.DDAY,
           y = NY.GDP.PCAP.CD,
           color = CountryName)) +
  geom_point(size = 3) +
  xlim(0,100) +
  labs(y = "GDP per capita",
       x = "Poverty headcount ratio at $1.90 a day (2011 PPP) (% of population)",
       title = "Higher per capita GDP is associated with a smaller poverty headcount",
       caption = "Data from 1993") + 
  theme_classic()
```



```{r}
#Check for Poverty headcount ratio at $3.10 a day
poverty_gap <- dplyr::filter(brics.Indicators, 
                      IndicatorCode == "SI.POV.2DAY" |
                      IndicatorCode == "NY.GDP.PCAP.CD") %>%
  dplyr::filter(      Year == 1993
                      ) %>%
  pivot_wider(names_from = "IndicatorCode",
              values_from = "Value")

pg_a <- filter(poverty_gap, IndicatorName == "GDP per capita (current US$)") %>%
  select(-IndicatorName, -SI.POV.2DAY)

pg_b <- filter(poverty_gap, IndicatorName == "Poverty headcount ratio at $3.10 a day (2011 PPP) (% of population)") %>%
  select(CountryCode, SI.POV.2DAY)

poverty_gap <- left_join(pg_a, pg_b, by = "CountryCode")

ggplot(data = poverty_gap,
       aes(x = SI.POV.2DAY,
           y = NY.GDP.PCAP.CD,
           color = CountryName)) +
  geom_point(size = 3) +
  xlim(0,100) +
  labs(y = "GDP per capita",
       x = "Poverty headcount ratio at $3.10 a day (2011 PPP) (% of population)",
       title = "Higher per capita GDP is associated with a smaller poverty headcount",
       caption = "Data from 1993") + 
  theme_classic()
```


```{r}
#Check out Agricultural land (% of land area)
agriculture_percent <- dplyr::filter(brics.Indicators, 
                      IndicatorCode == "AG.LND.AGRI.ZS" |
                      IndicatorCode == "NY.GDP.PCAP.CD")  %>%
  pivot_wider(names_from = "IndicatorCode",
              values_from = "Value")

ap_a <- filter(agriculture_percent, IndicatorName == "GDP per capita (current US$)") %>%
  select(-IndicatorName, -AG.LND.AGRI.ZS)

ap_b <- filter(agriculture_percent, IndicatorName == "Agricultural land (% of land area)") %>%
  select(CountryCode, AG.LND.AGRI.ZS, Year)

agriculture_percent <- left_join(ap_a, ap_b, by = c("CountryCode" = "CountryCode", "Year" = "Year"))

start <- filter(agriculture_percent, Year == 1961 | Year == 1992 & CountryName == "Russian Federation")

ggplot(data = agriculture_percent,
       aes(x = AG.LND.AGRI.ZS,
           y = NY.GDP.PCAP.CD,
           color = CountryName)) +
  geom_path() +
  geom_point(data = start,
             aes(
               x = AG.LND.AGRI.ZS,
               y = NY.GDP.PCAP.CD)
             ) +
  xlim(0,100) +
  labs(y = "GDP per capita",
       x = "Agricultural land (% of land area)",
       title = "Changes in agricultural holdings seem unrelated to changes in GDP per capita",
       caption = "Dot indicates first year of data."
       ) + 
  theme_classic()
```


```{r}
agriculture_employment <- dplyr::filter(brics.Indicators, 
                      IndicatorCode == "SL.AGR.EMPL.ZS" |
                      IndicatorCode == "NY.GDP.PCAP.CD")  %>%
  pivot_wider(names_from = "IndicatorCode",
              values_from = "Value")

em_a <- filter(agriculture_employment, IndicatorName == "GDP per capita (current US$)") %>%
  select(-IndicatorName, -SL.AGR.EMPL.ZS)

em_b <- filter(agriculture_employment, IndicatorName == "Employment in agriculture (% of total employment)") %>%
  select(CountryCode, SL.AGR.EMPL.ZS, Year)

agriculture_employment <- left_join(em_a, em_b, by = c("CountryCode" = "CountryCode", "Year" = "Year"))

ggplot(data = agriculture_employment,
       aes(x = SL.AGR.EMPL.ZS,
           y = NY.GDP.PCAP.CD,
           color = CountryName)) +
  geom_path() +
  geom_point() +
  xlim(0,100) +
  labs(y = "GDP per capita",
       x = "Employment in agriculture (% of total employment)",
       title = "A decrease in the employment of agriculture does lead to an increase in GDP"
       ) + 
  theme_classic()
```
